// all the logic of the system 